{% extends "layout.html" %}

{% block title %}
    Log In
{% endblock %}

{% block main %}
    <h5 style="color:blue;" align='center'>Redefinir senha</h5>

    {% if reset %}
    <form action="/reset" method="post">
        <div class="form-group">
            <input autocomplete="off" id="reset_token" autofocus class="form-control" name="reset_token" placeholder="Insira o código" type="text">
        </div>
        <div class="form-group">
            <input autocomplete="on" id="reset_username" autofocus class="form-control" name="reset_username" placeholder="E-mail" type="text">
        </div>
        <div class="form-group">
            <input id="password" class="form-control" name="password" placeholder="Nova senha" type="password">
        </div>
        <div class="form-group">
            <input id="confirm_password" class="form-control" name="confirm_password" placeholder="Confirme a nova senha" autocomplete="off" type="password">
        </div>
        <button class="btn btn-primary" type="submit" id="reset">Confirmar</button>
    </form>

    {% else %}
    <form action="/reset" method="post">
        <div class="form-group">
            <input autocomplete="off" id="username" autofocus class="form-control" name="username" placeholder="E-mail" type="text">
        </div>
        <button class="btn btn-primary" type="submit" id="login">Redefinir Senha</button>
    </form>

    {% endif %}

    <script>
        function validateFill(){
            if (document.getElementById("username").value) {
                document.getElementById("login").disabled = false;
            }
            else{
                document.getElementById("login").disabled = true;
            }
        }


        function validatePassword(){
            let password = document.getElementById("password")
          , confirm_password = document.getElementById("confirm_password");

          if(password.value != confirm_password.value) {
            confirm_password.setCustomValidity("As senhas não conferem");
          } else if (password.value.length < 6) {
            confirm_password.setCustomValidity("A senha deve ter pelo menos 6 caracteres");
          }
          else {
            confirm_password.setCustomValidity('');
          }
        }
        confirm_password.onkeyup = validatePassword;

    </script>
{% endblock %}
